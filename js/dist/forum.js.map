{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@flamarkt/identity/webpack/bootstrap","webpack://@flamarkt/identity/webpack/runtime/compat get default export","webpack://@flamarkt/identity/webpack/runtime/define property getters","webpack://@flamarkt/identity/webpack/runtime/hasOwnProperty shorthand","webpack://@flamarkt/identity/webpack/runtime/make namespace object","webpack://@flamarkt/identity/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@flamarkt/identity/external root \"flarum.core.compat['forum/app']\"","webpack://@flamarkt/identity/external root \"flarum.core.compat['common/extend']\"","webpack://@flamarkt/identity/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@flamarkt/identity/external root \"flarum.core.compat['forum/components/SignUpModal']\"","webpack://@flamarkt/identity/external root \"((flarum.extensions['flamarkt-core']||{})['forum']||{})['utils/AccountControls']\"","webpack://@flamarkt/identity/./src/common/states/IdentityFieldsState.ts","webpack://@flamarkt/identity/external root \"flarum.core.compat['common/app']\"","webpack://@flamarkt/identity/./src/common/utils/identityFields.ts","webpack://@flamarkt/identity/./src/common/compat.ts","webpack://@flamarkt/identity/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flamarkt/identity/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flamarkt/identity/external root \"((flarum.extensions['flamarkt-core']||{})['forum']||{})['layouts/AbstractAccountLayout']\"","webpack://@flamarkt/identity/external root \"flarum.core.compat['common/components/Button']\"","webpack://@flamarkt/identity/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@flamarkt/identity/./src/forum/layouts/IdentityLayout.ts","webpack://@flamarkt/identity/external root \"flarum.core.compat['common/components/Page']\"","webpack://@flamarkt/identity/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@flamarkt/identity/./src/forum/pages/IdentityPage.ts","webpack://@flamarkt/identity/./src/forum/compat.ts","webpack://@flamarkt/identity/external root \"flarum.core.compat['common/models/User']\"","webpack://@flamarkt/identity/external root \"flarum.core.compat['common/Model']\"","webpack://@flamarkt/identity/./src/forum/index.ts","webpack://@flamarkt/identity/./src/common/addUserAttributes.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SignUpModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['forum']||{})['utils/AccountControls'];","import User from 'flarum/common/models/User';\n\nexport default class IdentityFieldsState {\n    firstname: string = '';\n    lastname: string = '';\n    birthday: string = '';\n    addressStreet: string = '';\n    addressNumber: string = '';\n    addressCity: string = '';\n    addressZip: string = '';\n    addressState: string = '';\n    addressCountry: string = '';\n\n    valuesFromUser(user: User) {\n        this.firstname = user.firstname() || '';\n        this.lastname = user.lastname() || '';\n        this.birthday = user.birthday() || '';\n        this.addressStreet = user.addressStreet() || '';\n        this.addressNumber = user.addressNumber() || '';\n        this.addressCity = user.addressCity() || '';\n        this.addressZip = user.addressZip() || '';\n        this.addressState = user.addressState() || '';\n        this.addressCountry = user.addressCountry() || '';\n    }\n\n    data(): any {\n        return {\n            firstname: this.firstname,\n            lastname: this.lastname,\n            birthday: this.birthday,\n            addressStreet: this.addressStreet,\n            addressNumber: this.addressNumber,\n            addressCity: this.addressCity,\n            addressZip: this.addressZip,\n            addressState: this.addressState,\n            addressCountry: this.addressCountry,\n        };\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","import app from 'flarum/common/app';\nimport {Children} from 'mithril';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport IdentityFieldsState from '../states/IdentityFieldsState';\n\nexport interface IdentityFieldsOptions {\n    onchange?: () => void\n    disabled?: boolean\n}\n\nexport default function (items: ItemList<Children>, state: IdentityFieldsState, options: IdentityFieldsOptions = {}): ItemList<Children> {\n    items.add('flamarkt-identity-firstname', m('.Form-group', [\n        m('label', {\n            for: 'settings-firstname',\n        }, app.translator.trans('flamarkt-identity.lib.field.firstname')),\n        m('input.FormControl', {\n            id: 'settings-firstname',\n            type: 'text',\n            value: state.firstname,\n            oninput: (event: Event) => {\n                state.firstname = (event.target as HTMLInputElement).value;\n                options.onchange?.();\n            },\n            disabled: options.disabled,\n        }),\n    ]));\n\n    items.add('flamarkt-identity-lastname', m('.Form-group', [\n        m('label', {\n            for: 'settings-lastname',\n        }, app.translator.trans('flamarkt-identity.lib.field.lastname')),\n        m('input.FormControl', {\n            id: 'settings-lastname',\n            type: 'text',\n            value: state.lastname,\n            oninput: (event: Event) => {\n                state.lastname = (event.target as HTMLInputElement).value;\n                options.onchange?.();\n            },\n            disabled: options.disabled,\n        }),\n    ]));\n\n    items.add('flamarkt-identity-birthday', m('.Form-group', [\n        m('label', {\n            for: 'settings-birthday',\n        }, app.translator.trans('flamarkt-identity.lib.field.birthday')),\n        m('input.FormControl', {\n            id: 'settings-birthday',\n            type: 'date',\n            value: state.birthday,\n            oninput: (event: Event) => {\n                state.birthday = (event.target as HTMLInputElement).value;\n                options.onchange?.();\n            },\n            disabled: options.disabled,\n        }),\n    ]));\n\n    items.add('flamarkt-identity-addressStreet', m('.Form-group', [\n        m('label', {\n            for: 'settings-addressStreet',\n        }, app.translator.trans('flamarkt-identity.lib.field.addressStreet')),\n        m('input.FormControl', {\n            id: 'settings-addressStreet',\n            type: 'text',\n            value: state.addressStreet,\n            oninput: (event: Event) => {\n                state.addressStreet = (event.target as HTMLInputElement).value;\n                options.onchange?.();\n            },\n            disabled: options.disabled,\n        }),\n    ]));\n\n    items.add('flamarkt-identity-addressNumber', m('.Form-group', [\n        m('label', {\n            for: 'settings-addressNumber',\n        }, app.translator.trans('flamarkt-identity.lib.field.addressNumber')),\n        m('input.FormControl', {\n            id: 'settings-addressNumber',\n            type: 'text',\n            value: state.addressNumber,\n            oninput: (event: Event) => {\n                state.addressNumber = (event.target as HTMLInputElement).value;\n                options.onchange?.();\n            },\n            disabled: options.disabled,\n        }),\n    ]));\n\n    items.add('flamarkt-identity-addressCity', m('.Form-group', [\n        m('label', {\n            for: 'settings-addressCity',\n        }, app.translator.trans('flamarkt-identity.lib.field.addressCity')),\n        m('input.FormControl', {\n            id: 'settings-addressCity',\n            type: 'text',\n            value: state.addressCity,\n            oninput: (event: Event) => {\n                state.addressCity = (event.target as HTMLInputElement).value;\n                options.onchange?.();\n            },\n            disabled: options.disabled,\n        }),\n    ]));\n\n    items.add('flamarkt-identity-addressZip', m('.Form-group', [\n        m('label', {\n            for: 'settings-addressZip',\n        }, app.translator.trans('flamarkt-identity.lib.field.addressZip')),\n        m('input.FormControl', {\n            id: 'settings-addressZip',\n            type: 'text',\n            value: state.addressZip,\n            oninput: (event: Event) => {\n                state.addressZip = (event.target as HTMLInputElement).value;\n                options.onchange?.();\n            },\n            disabled: options.disabled,\n        }),\n    ]));\n\n    items.add('flamarkt-identity-addressState', m('.Form-group', [\n        m('label', {\n            for: 'settings-addressState',\n        }, app.translator.trans('flamarkt-identity.lib.field.addressState')),\n        m('input.FormControl', {\n            id: 'settings-addressState',\n            type: 'text',\n            value: state.addressState,\n            oninput: (event: Event) => {\n                state.addressState = (event.target as HTMLInputElement).value;\n                options.onchange?.();\n            },\n            disabled: options.disabled,\n        }),\n    ]));\n\n    items.add('flamarkt-identity-addressCountry', m('.Form-group', [\n        m('label', {\n            for: 'settings-addressCountry',\n        }, app.translator.trans('flamarkt-identity.lib.field.addressCountry')),\n        m('input.FormControl', {\n            id: 'settings-addressCountry',\n            type: 'text',\n            value: state.addressCountry,\n            oninput: (event: Event) => {\n                state.addressCountry = (event.target as HTMLInputElement).value;\n                options.onchange?.();\n            },\n            disabled: options.disabled,\n        }),\n    ]));\n\n    return items;\n}\n","import IdentityFieldsState from './states/IdentityFieldsState';\nimport identityFields from './utils/identityFields';\n\nexport const common = {\n    'states/IdentityFieldsState': IdentityFieldsState,\n    'utils/identityFields': identityFields,\n}\n","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['forum']||{})['layouts/AbstractAccountLayout'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","import {Children, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport AbstractAccountLayout from 'flamarkt/core/forum/layouts/AbstractAccountLayout';\nimport Button from 'flarum/common/components/Button';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport IdentityFieldsState from '../../common/states/IdentityFieldsState';\nimport identityFields from '../../common/utils/identityFields';\n\nexport default class IdentityLayout extends AbstractAccountLayout {\n    identityState: IdentityFieldsState = new IdentityFieldsState();\n    dirty: boolean = false;\n    saving: boolean = false;\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        if (app.session.user) {\n            this.identityState.valuesFromUser(app.session.user);\n        }\n    }\n\n    currentPageHref() {\n        return app.route('flamarkt.account.identity');\n    }\n\n    title() {\n        return app.translator.trans('flamarkt-identity.forum.account.headingTitle');\n    }\n\n    content() {\n        if (!app.session.user) {\n            return m('div', 'Logged out');\n        }\n\n        return m('form', {\n            onsubmit: this.onsubmit.bind(this),\n        }, this.fields().toArray());\n    }\n\n    fields() {\n        const fields = new ItemList<Children>();\n\n        fields.add('submit', m('.Form-group', Button.component({\n            type: 'submit',\n            className: 'Button Button--primary',\n            loading: this.saving,\n            disabled: !this.dirty,\n        }, app.translator.trans('flamarkt-identity.forum.account.submit'))), -10);\n\n        return identityFields(fields, this.identityState, {\n            onchange: () => {\n                this.dirty = true;\n            },\n            disabled: this.saving,\n        });\n    }\n\n    data(): any {\n        return {\n            ...this.identityState.data(),\n        };\n    }\n\n    onsubmit(event: Event) {\n        event.preventDefault();\n\n        this.saving = true;\n\n        app.session.user!.save(this.data()).then(() => {\n            this.saving = false;\n            this.dirty = false;\n\n            m.redraw();\n        }).catch(error => {\n            this.saving = false;\n\n            m.redraw();\n\n            throw error;\n        });\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","import {VnodeDOM} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Page from 'flarum/common/components/Page';\nimport extractText from 'flarum/common/utils/extractText';\nimport IdentityLayout from '../layouts/IdentityLayout';\n\nexport default class AccountPage extends Page {\n    oncreate(vnode: VnodeDOM) {\n        super.oncreate(vnode);\n\n        app.setTitle(extractText(app.translator.trans('flamarkt-identity.forum.account.browserTitle')));\n        app.setTitleCount(0);\n    }\n\n    view() {\n        return IdentityLayout.component();\n    }\n}\n","import IdentityLayout from './layouts/IdentityLayout';\nimport IdentityPage from './pages/IdentityPage';\n\nexport const forum = {\n    'layouts/IdentityLayout': IdentityLayout,\n    'pages/IdentityPage': IdentityPage,\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/User'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import app from 'flarum/forum/app';\nimport {extend, override} from 'flarum/common/extend';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport SignUpModal from 'flarum/forum/components/SignUpModal';\nimport AccountControls from 'flamarkt/core/forum/utils/AccountControls';\nimport {common} from '../common/compat';\nimport {forum} from './compat';\nimport IdentityPage from './pages/IdentityPage';\nimport IdentityFieldsState from '../common/states/IdentityFieldsState';\nimport addUserAttributes from '../common/addUserAttributes';\nimport identityFields from '../common/utils/identityFields';\n\nexport {\n    common,\n    forum,\n};\n\napp.initializers.add('flamarkt-identity', () => {\n    addUserAttributes();\n\n    app.routes['flamarkt.account.identity'] = {\n        path: '/account/identity',\n        component: IdentityPage,\n    };\n\n    extend(AccountControls, 'controls', function (items) {\n        items.add('identity', LinkButton.component({\n            href: app.route('flamarkt.account.identity'),\n        }, app.translator.trans('flamarkt-identity.forum.account.nav')));\n    });\n\n    extend(SignUpModal.prototype, 'oninit', function () {\n        this.flamarktIdentityState = new IdentityFieldsState();\n    });\n\n    extend(SignUpModal.prototype, 'fields', function (fields) {\n        identityFields(fields, this.flamarktIdentityState, {\n            disabled: this.loading,\n        });\n    });\n\n    override(SignUpModal.prototype, 'submitData', function (original: any) {\n        return {\n            ...original(),\n            ...this.flamarktIdentityState.data(),\n        };\n    });\n});\n","import User from 'flarum/common/models/User';\nimport Model from 'flarum/common/Model';\n\nexport default function () {\n    User.prototype.firstname = Model.attribute('firstname');\n    User.prototype.lastname = Model.attribute('lastname');\n    User.prototype.birthday = Model.attribute('birthday');\n    User.prototype.addressStreet = Model.attribute('addressStreet');\n    User.prototype.addressNumber = Model.attribute('addressNumber');\n    User.prototype.addressCity = Model.attribute('addressCity');\n    User.prototype.addressZip = Model.attribute('addressZip');\n    User.prototype.addressState = Model.attribute('addressState');\n    User.prototype.addressCountry = Model.attribute('addressCountry');\n    //TODO: phone\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","_extends","assign","bind","target","i","arguments","length","source","apply","this","flarum","core","compat","extensions","IdentityFieldsState","firstname","lastname","birthday","addressStreet","addressNumber","addressCity","addressZip","addressState","addressCountry","valuesFromUser","user","data","items","state","options","add","m","for","app","id","type","oninput","event","onchange","disabled","common","identityFields","_setPrototypeOf","p","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","create","constructor","IdentityLayout","identityState","dirty","saving","oninit","vnode","currentPageHref","title","content","onsubmit","fields","toArray","ItemList","Button","className","loading","preventDefault","then","redraw","error","AbstractAccountLayout","AccountPage","oncreate","extractText","view","component","Page","forum","IdentityPage","User","Model","path","extend","AccountControls","LinkButton","href","SignUpModal","flamarktIdentityState","override","original"],"sourceRoot":""}