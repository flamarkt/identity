(()=>{var t={n:e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return t.d(a,{a}),a},d:(e,a)=>{for(var r in a)t.o(a,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:a[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";function a(){return a=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},a.apply(this,arguments)}t.r(e),t.d(e,{common:()=>h,forum:()=>I});const r=flarum.core.compat["forum/app"];var n=t.n(r);const s=flarum.core.compat["common/extend"],i=flarum.core.compat["common/components/LinkButton"];var o=t.n(i);const d=flarum.core.compat["forum/components/SignUpModal"];var l=t.n(d);const u=((flarum.extensions["flamarkt-core"]||{}).forum||{})["utils/AccountControls"];var c=t.n(u),f=function(){function t(){this.firstname="",this.lastname="",this.birthday="",this.addressStreet="",this.addressNumber="",this.addressCity="",this.addressZip="",this.addressState="",this.addressCountry=""}var e=t.prototype;return e.valuesFromUser=function(t){this.firstname=t.firstname()||"",this.lastname=t.lastname()||"",this.birthday=t.birthday()||"",this.addressStreet=t.addressStreet()||"",this.addressNumber=t.addressNumber()||"",this.addressCity=t.addressCity()||"",this.addressZip=t.addressZip()||"",this.addressState=t.addressState()||"",this.addressCountry=t.addressCountry()||""},e.data=function(){return{firstname:this.firstname,lastname:this.lastname,birthday:this.birthday,addressStreet:this.addressStreet,addressNumber:this.addressNumber,addressCity:this.addressCity,addressZip:this.addressZip,addressState:this.addressState,addressCountry:this.addressCountry}},t}();const p=flarum.core.compat["common/app"];var y=t.n(p);function b(t,e,a){return void 0===a&&(a={}),t.add("flamarkt-identity-firstname",m(".Form-group",[m("label",{for:"settings-firstname"},y().translator.trans("flamarkt-identity.lib.field.firstname")),m("input.FormControl",{id:"settings-firstname",type:"text",value:e.firstname,oninput:function(t){e.firstname=t.target.value,null==a.onchange||a.onchange()},disabled:a.disabled})])),t.add("flamarkt-identity-lastname",m(".Form-group",[m("label",{for:"settings-lastname"},y().translator.trans("flamarkt-identity.lib.field.lastname")),m("input.FormControl",{id:"settings-lastname",type:"text",value:e.lastname,oninput:function(t){e.lastname=t.target.value,null==a.onchange||a.onchange()},disabled:a.disabled})])),t.add("flamarkt-identity-birthday",m(".Form-group",[m("label",{for:"settings-birthday"},y().translator.trans("flamarkt-identity.lib.field.birthday")),m("input.FormControl",{id:"settings-birthday",type:"date",value:e.birthday,oninput:function(t){e.birthday=t.target.value,null==a.onchange||a.onchange()},disabled:a.disabled})])),t.add("flamarkt-identity-addressStreet",m(".Form-group",[m("label",{for:"settings-addressStreet"},y().translator.trans("flamarkt-identity.lib.field.addressStreet")),m("input.FormControl",{id:"settings-addressStreet",type:"text",value:e.addressStreet,oninput:function(t){e.addressStreet=t.target.value,null==a.onchange||a.onchange()},disabled:a.disabled})])),t.add("flamarkt-identity-addressNumber",m(".Form-group",[m("label",{for:"settings-addressNumber"},y().translator.trans("flamarkt-identity.lib.field.addressNumber")),m("input.FormControl",{id:"settings-addressNumber",type:"text",value:e.addressNumber,oninput:function(t){e.addressNumber=t.target.value,null==a.onchange||a.onchange()},disabled:a.disabled})])),t.add("flamarkt-identity-addressCity",m(".Form-group",[m("label",{for:"settings-addressCity"},y().translator.trans("flamarkt-identity.lib.field.addressCity")),m("input.FormControl",{id:"settings-addressCity",type:"text",value:e.addressCity,oninput:function(t){e.addressCity=t.target.value,null==a.onchange||a.onchange()},disabled:a.disabled})])),t.add("flamarkt-identity-addressZip",m(".Form-group",[m("label",{for:"settings-addressZip"},y().translator.trans("flamarkt-identity.lib.field.addressZip")),m("input.FormControl",{id:"settings-addressZip",type:"text",value:e.addressZip,oninput:function(t){e.addressZip=t.target.value,null==a.onchange||a.onchange()},disabled:a.disabled})])),t.add("flamarkt-identity-addressState",m(".Form-group",[m("label",{for:"settings-addressState"},y().translator.trans("flamarkt-identity.lib.field.addressState")),m("input.FormControl",{id:"settings-addressState",type:"text",value:e.addressState,oninput:function(t){e.addressState=t.target.value,null==a.onchange||a.onchange()},disabled:a.disabled})])),t.add("flamarkt-identity-addressCountry",m(".Form-group",[m("label",{for:"settings-addressCountry"},y().translator.trans("flamarkt-identity.lib.field.addressCountry")),m("input.FormControl",{id:"settings-addressCountry",type:"text",value:e.addressCountry,oninput:function(t){e.addressCountry=t.target.value,null==a.onchange||a.onchange()},disabled:a.disabled})])),t}var h={"states/IdentityFieldsState":f,"utils/identityFields":b};function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}function v(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,g(t,e)}const S=((flarum.extensions["flamarkt-core"]||{}).forum||{})["layouts/AbstractAccountLayout"];var C=t.n(S);const k=flarum.core.compat["common/components/Button"];var F=t.n(k);const x=flarum.core.compat["common/utils/ItemList"];var N=t.n(x),O=function(t){function e(){for(var e,a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))||this).identityState=new f,e.dirty=!1,e.saving=!1,e}v(e,t);var r=e.prototype;return r.oninit=function(e){t.prototype.oninit.call(this,e),n().session.user&&this.identityState.valuesFromUser(n().session.user)},r.currentPageHref=function(){return n().route("flamarkt.account.identity")},r.title=function(){return n().translator.trans("flamarkt-identity.forum.account.headingTitle")},r.content=function(){return n().session.user?m("form",{onsubmit:this.onsubmit.bind(this)},this.fields().toArray()):m("div","Logged out")},r.fields=function(){var t=this,e=new(N());return e.add("submit",m(".Form-group",F().component({type:"submit",className:"Button Button--primary",loading:this.saving,disabled:!this.dirty},n().translator.trans("flamarkt-identity.forum.account.submit"))),-10),b(e,this.identityState,{onchange:function(){t.dirty=!0},disabled:this.saving})},r.data=function(){return a({},this.identityState.data())},r.onsubmit=function(t){var e=this;t.preventDefault(),this.saving=!0,n().session.user.save(this.data()).then((function(){e.saving=!1,e.dirty=!1,m.redraw()})).catch((function(t){throw e.saving=!1,m.redraw(),t}))},e}(C());const Z=flarum.core.compat["common/components/Page"];var w=t.n(Z);const j=flarum.core.compat["common/utils/extractText"];var P=t.n(j),_=function(t){function e(){return t.apply(this,arguments)||this}v(e,t);var a=e.prototype;return a.oncreate=function(e){t.prototype.oncreate.call(this,e),n().setTitle(P()(n().translator.trans("flamarkt-identity.forum.account.browserTitle"))),n().setTitleCount(0)},a.view=function(){return O.component()},e}(w()),I={"layouts/IdentityLayout":O,"pages/IdentityPage":_};const T=flarum.core.compat["common/models/User"];var A=t.n(T);const L=flarum.core.compat["common/Model"];var M=t.n(L);n().initializers.add("flamarkt-identity",(function(){A().prototype.firstname=M().attribute("firstname"),A().prototype.lastname=M().attribute("lastname"),A().prototype.birthday=M().attribute("birthday"),A().prototype.addressStreet=M().attribute("addressStreet"),A().prototype.addressNumber=M().attribute("addressNumber"),A().prototype.addressCity=M().attribute("addressCity"),A().prototype.addressZip=M().attribute("addressZip"),A().prototype.addressState=M().attribute("addressState"),A().prototype.addressCountry=M().attribute("addressCountry"),n().routes["flamarkt.account.identity"]={path:"/account/identity",component:_},(0,s.extend)(c(),"controls",(function(t){t.add("identity",o().component({href:n().route("flamarkt.account.identity")},n().translator.trans("flamarkt-identity.forum.account.nav")))})),(0,s.extend)(l().prototype,"oninit",(function(){this.flamarktIdentityState=new f})),(0,s.extend)(l().prototype,"fields",(function(t){b(t,this.flamarktIdentityState,{disabled:this.loading})})),(0,s.override)(l().prototype,"submitData",(function(t){return a({},t(),this.flamarktIdentityState.data())}))}))})(),module.exports=e})();
//# sourceMappingURL=forum.js.map